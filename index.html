<!DOCTYPE html> 
<html lang="en">
<head>
<meta charset="UTF-8">
<title>🧮 Equation Master Challenge</title>
<style>
body {
  margin:0; font-family:"Poppins",sans-serif; overflow:hidden;
  background:linear-gradient(135deg,#e3f2fd,#bbdefb);
}
#levelSelectBox {
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  background:white; padding:25px; border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.3); text-align:center; z-index:20;
}
button {
  padding:10px 18px; font-size:16px; border:none; border-radius:8px;
  background:#1565c0; color:white; cursor:pointer; margin:6px;
}
button:hover { background:#0d47a1; }
#questionBox {
  position:absolute; top:10px; left:50%; transform:translateX(-50%);
  background:white; padding:15px 25px; border-radius:10px;
  box-shadow:0 4px 6px rgba(0,0,0,0.3);
  display:none; flex-direction:column; align-items:center; gap:10px; z-index:10;
}
#question { font-weight:bold; font-size:20px; text-align:center; }
#choices {
  display:grid; grid-template-columns:repeat(2,160px); gap:10px;
}
.choiceBtn {
  background:#0077cc; color:white; border:none; border-radius:8px;
  font-size:15px; padding:8px 10px; cursor:pointer;
}
.choiceBtn:hover { background:#005fa3; }
#answerInput {
  font-size:17px; padding:6px; width:300px; text-align:center;
  border:2px solid #333; border-radius:6px;
}
#hintDisplay {
  position:absolute; top:150px; left:50%; transform:translateX(-50%);
  font-size:17px; font-weight:bold; color:orange;
}
#correctPopup {
  position:absolute; top:200px; left:50%; transform:translateX(-50%);
  font-size:26px; font-weight:bold; color:green;
  opacity:0; transition:opacity .5s ease;
}
#restartBtn, #homeBtn {
  position:absolute; top:10px; font-size:16px; padding:5px 10px;
  cursor:pointer; border:none; border-radius:8px; z-index:10;
}
#restartBtn { right:10px; background:#ff7043; color:white; }
#homeBtn { left:10px; background:#26a69a; color:white; }
#scoreDisplay { font-weight:bold; color:#1565c0; font-size:17px; }
canvas { display:block; pointer-events:none; }
</style>
</head>
<body>
<div id="levelSelectBox">
  <h2>🧮 Equation Master Challenge</h2>
  <p>Select your level:</p>
  <button onclick="startGame(1)">Level 1 - One-Step Equations</button><br>
  <button onclick="startGame(2)">Level 2 - Two-Step Equations</button><br>
  <button onclick="startGame(3)">Level 3 - Three-Step Equations</button>
</div>

<div id="questionBox">
  <div id="scoreDisplay">Score: 0 / 10</div>
  <div id="question">Loading...</div>
  <input id="answerInput" type="text" readonly placeholder="Select your answer">
  <div id="choices"></div>
  <div>
    <button id="submitBtn">Submit</button>
    <button id="hintBtn" style="background:orange;">Hint</button>
  </div>
</div>

<div id="hintDisplay"></div>
<div id="correctPopup">✅ Correct!</div>
<button id="restartBtn">Restart</button>
<button id="homeBtn">Home</button>
<canvas id="gameCanvas"></canvas>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<audio id="clapSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3b1f4d033d.mp3?filename=clapping-44774.mp3"></audio>

<script>
// --- 3D Setup ---
const canvas=document.getElementById("gameCanvas");
const renderer=new THREE.WebGLRenderer({canvas});
renderer.setSize(window.innerWidth,window.innerHeight);
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
camera.position.set(0,10,20); camera.lookAt(0,0,0);
scene.add(new THREE.DirectionalLight(0xffffff,1));
scene.add(new THREE.AmbientLight(0x404040,1.5));
const ground=new THREE.Mesh(new THREE.PlaneGeometry(100,100),new THREE.MeshLambertMaterial({color:0xbbdefb}));
ground.rotation.x=-Math.PI/2; scene.add(ground);
const player=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshLambertMaterial({color:0x1565c0}));
player.position.set(0,0.5,0); scene.add(player);

let barriers=[];
function createBarriers(){
  barriers.forEach(b=>scene.remove(b.mesh)); barriers=[];
  for(let i=0;i<10;i++){
    const barrier=new THREE.Mesh(new THREE.BoxGeometry(2,2,2),new THREE.MeshLambertMaterial({color:0xff5252}));
    barrier.position.set(0,1,-4*i);
    scene.add(barrier);
    barriers.push({mesh:barrier});
  }
}

// --- Question Bank ---
const qData={
  1:[ // One-Step Equations
    {q:"x + 7 = 12", a:"5", choices:["3","4","5","6"], hint:"Subtract 7 from both sides."},
    {q:"x - 6 = 9", a:"15", choices:["11","13","14","15"], hint:"Add 6 to both sides."},
    {q:"3x = 18", a:"6", choices:["5","6","7","8"], hint:"Divide both sides by 3."},
    {q:"x / 4 = 5", a:"20", choices:["10","15","20","25"], hint:"Multiply both sides by 4."},
    {q:"x - 3 = 2", a:"5", choices:["4","5","6","7"], hint:"Add 3 to both sides."},
    {q:"x + 9 = 20", a:"11", choices:["9","10","11","12"], hint:"Subtract 9 from both sides."},
    {q:"8x = 64", a:"8", choices:["7","8","9","10"], hint:"Divide by 8."},
    {q:"x / 2 = 10", a:"20", choices:["18","19","20","21"], hint:"Multiply both sides by 2."},
    {q:"x - 12 = 8", a:"20", choices:["16","18","20","22"], hint:"Add 12 to both sides."},
    {q:"5x = 25", a:"5", choices:["4","5","6","7"], hint:"Divide both sides by 5."}
  ],
  2:[ // Two-Step Equations
    {q:"2x + 5 = 13", a:"4", choices:["3","4","5","6"], hint:"Subtract 5 then divide by 2."},
    {q:"3x - 4 = 8", a:"4", choices:["3","4","5","6"], hint:"Add 4 then divide by 3."},
    {q:"5x + 7 = 22", a:"3", choices:["2","3","4","5"], hint:"Subtract 7 then divide by 5."},
    {q:"6x - 2 = 10", a:"2", choices:["1","2","3","4"], hint:"Add 2 then divide by 6."},
    {q:"4x + 9 = 25", a:"4", choices:["3","4","5","6"], hint:"Subtract 9 then divide by 4."},
    {q:"7x - 5 = 16", a:"3", choices:["2","3","4","5"], hint:"Add 5 then divide by 7."},
    {q:"2x + 9 = 15", a:"3", choices:["2","3","4","5"], hint:"Subtract 9 then divide by 2."},
    {q:"9x - 12 = 6", a:"2", choices:["1","2","3","4"], hint:"Add 12 then divide by 9."},
    {q:"3x + 8 = 14", a:"2", choices:["1","2","3","4"], hint:"Subtract 8 then divide by 3."},
    {q:"8x - 4 = 20", a:"3", choices:["2","3","4","5"], hint:"Add 4 then divide by 8."}
  ],
  3:[ // Three-Step Equations
    {q:"2(x + 3) = 14", a:"4", choices:["3","4","5","6"], hint:"Divide by 2 first, then subtract 3."},
    {q:"3(x - 2) + 4 = 10", a:"4", choices:["3","4","5","6"], hint:"Simplify step-by-step."},
    {q:"4(x + 1) = 20", a:"4", choices:["4","5","6","3"], hint:"Divide by 4, then subtract 1."},
    {q:"5x - 3 = 2x + 9", a:"4", choices:["3","4","5","6"], hint:"Bring variables to one side."},
    {q:"2(x - 5) + 8 = 14", a:"8", choices:["6","7","8","9"], hint:"Expand, simplify, solve."},
    {q:"3(x + 2) - 5 = 10", a:"3", choices:["2","3","4","5"], hint:"Simplify then isolate x."},
    {q:"4(x - 3) + 2 = 10", a:"5", choices:["4","5","6","7"], hint:"Simplify step-by-step."},
    {q:"6x - (2x + 4) = 8", a:"3", choices:["2","3","4","5"], hint:"Expand, then simplify."},
    {q:"2(x + 4) - 6 = 8", a:"5", choices:["4","5","6","7"], hint:"Simplify and isolate x."},
    {q:"7x - 2(3x - 4) = 10", a:"3", choices:["2","3","4","5"], hint:"Expand brackets and simplify."}
  ]
};

// --- Core Logic ---
let questions=[],currentQ=0,score=0;
const questionEl=document.getElementById("question");
const answerInput=document.getElementById("answerInput");
const choicesDiv=document.getElementById("choices");
const correctPopup=document.getElementById("correctPopup");
const hintDisplay=document.getElementById("hintDisplay");
const scoreDisplay=document.getElementById("scoreDisplay");
const clapSound=document.getElementById("clapSound");

function loadQuestion(){
  if(currentQ<questions.length){
    const qObj=questions[currentQ];
    questionEl.textContent=`Solve for x: ${qObj.q}`;
    answerInput.value=""; hintDisplay.textContent="";
    scoreDisplay.textContent=`Score: ${score} / ${questions.length}`;
    choicesDiv.innerHTML="";
    qObj.choices.forEach(ch=>{
      const btn=document.createElement("button");
      btn.textContent=ch;
      btn.className="choiceBtn";
      btn.onclick=()=>answerInput.value=ch;
      choicesDiv.appendChild(btn);
    });
  } else {
    confetti({particleCount:300,spread:150,origin:{y:0.6}});
    alert(`🎉 Level Complete! Final Score: ${score}/${questions.length}`);
    document.getElementById("questionBox").style.display="none";
    document.getElementById("levelSelectBox").style.display="block";
  }
}

function submitAnswer(){
  const ans=answerInput.value.trim();
  const correct=questions[currentQ].a;
  if(ans===correct){
    clapSound.play();
    if(barriers[currentQ]) barriers[currentQ].mesh.visible=false;
    score++;
    correctPopup.style.opacity=1;
    confetti({particleCount:100,spread:80,origin:{y:0.6}});
    setTimeout(()=>{correctPopup.style.opacity=0;currentQ++;loadQuestion();},1000);
  } else alert("❌ Try again!");
}

document.getElementById("submitBtn").addEventListener("click",submitAnswer);
document.getElementById("hintBtn").addEventListener("click",()=>{if(currentQ<questions.length)hintDisplay.textContent="💡 "+questions[currentQ].hint;});
document.getElementById("restartBtn").addEventListener("click",restartGame);
document.getElementById("homeBtn").addEventListener("click",()=>{document.getElementById("levelSelectBox").style.display="block";document.getElementById("questionBox").style.display="none";});

function restartGame(){
  score=0;currentQ=0;createBarriers();loadQuestion();
}

function startGame(level){
  document.getElementById("levelSelectBox").style.display="none";
  document.getElementById("questionBox").style.display="flex";
  questions=qData[level].sort(()=>0.5-Math.random()).slice(0,10);
  score=0;currentQ=0;createBarriers();loadQuestion();
}

function animate(){requestAnimationFrame(animate);renderer.render(scene,camera);}
animate();
</script>
</body>
</html>


